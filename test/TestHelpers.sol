// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "forge-std/Test.sol";
import {IHooks} from "v4-core/interfaces/IHooks.sol";
import {Hooks} from "v4-core/libraries/Hooks.sol";
import {TickMath} from "v4-core/libraries/TickMath.sol";
import {IPoolManager} from "v4-core/interfaces/IPoolManager.sol";
import {PoolKey} from "v4-core/types/PoolKey.sol";
import {BalanceDelta} from "v4-core/types/BalanceDelta.sol";
import {PoolId, PoolIdLibrary} from "v4-core/types/PoolId.sol";
import {CurrencyLibrary, Currency} from "v4-core/types/Currency.sol";
import {PoolSwapTest} from "v4-core/test/PoolSwapTest.sol";
import {Deployers} from "@uniswap/v4-core/test/utils/Deployers.sol";
import {SandwichProtectorHook} from "../src/SandwichProtectorHook.sol";
import {IERC20Minimal} from "v4-core/interfaces/external/IERC20Minimal.sol";
import {LPFeeLibrary} from "v4-core/libraries/LPFeeLibrary.sol";

library TestHelpers {
    /// returns a list of ModifyLiquidityParams that represent a normal distribution of liquidity across the pool
    /// total liquidity added is 1e8 * 1e18 === 100M tokens. Token prices are 1:1
    function getNormallyDistributedTicks() internal pure returns (IPoolManager.ModifyLiquidityParams[132] memory) {
        return [
            IPoolManager.ModifyLiquidityParams({tickLower: -3960,tickUpper: -3900,liquidityDelta: 1062225846228752400384,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3900,tickUpper: -3840,liquidityDelta: 1342181712767047172096,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3840,tickUpper: -3780,liquidityDelta: 1689829072322115665920,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3780,tickUpper: -3720,liquidityDelta: 2119879843725828423680,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3720,tickUpper: -3660,liquidityDelta: 2649822119797871083520,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3660,tickUpper: -3600,liquidityDelta: 3300343961903751495680,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3600,tickUpper: -3540,liquidityDelta: 4095799564186837057536,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3540,tickUpper: -3480,liquidityDelta: 5064717126671995502592,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3480,tickUpper: -3420,liquidityDelta: 6240346442555494236160,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3420,tickUpper: -3360,liquidityDelta: 7661242608403923075072,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3360,tickUpper: -3300,liquidityDelta: 9371880400393041084416,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3300,tickUpper: -3240,liquidityDelta: 11423291728075851563008,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3240,tickUpper: -3180,liquidityDelta: 13873716193697369948160,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3180,tickUpper: -3120,liquidityDelta: 16789252177319044317184,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3120,tickUpper: -3060,liquidityDelta: 20244493078656779812864,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3060,tickUpper: -3000,liquidityDelta: 24323130434955411193856,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -3000,tickUpper: -2940,liquidityDelta: 29118502677576062861312,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2940,tickUpper: -2880,liquidityDelta: 34734065383714683092992,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2880,tickUpper: -2820,liquidityDelta: 41283756137246747525120,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2820,tickUpper: -2760,liquidityDelta: 48892224664359296565248,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2760,tickUpper: -2700,liquidityDelta: 57694896900322856271872,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2700,tickUpper: -2640,liquidityDelta: 67837840229610760962048,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2640,tickUpper: -2580,liquidityDelta: 79477396485521444700160,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2580,tickUpper: -2520,liquidityDelta: 92779549561478180765696,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2520,tickUpper: -2460,liquidityDelta: 107918995832376674746368,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2460,tickUpper: -2400,liquidityDelta: 125077888155303874134016,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2400,tickUpper: -2340,liquidityDelta: 144444228136940716687360,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2340,tickUpper: -2280,liquidityDelta: 166209886711126939402240,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2280,tickUpper: -2220,liquidityDelta: 190568239914837732229120,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2220,tickUpper: -2160,liquidityDelta: 217711415085963902189568,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2160,tickUpper: -2100,liquidityDelta: 247827152475547766882304,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2100,tickUpper: -2040,liquidityDelta: 281095298351448939560960,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -2040,tickUpper: -1980,liquidityDelta: 317683957881320612298752,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1980,tickUpper: -1920,liquidityDelta: 357745349162100357857280,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1920,tickUpper: -1860,liquidityDelta: 401411413382041327108096,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1860,tickUpper: -1800,liquidityDelta: 448789249865393962483712,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1800,tickUpper: -1740,liquidityDelta: 499956458206400786464768,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1740,tickUpper: -1680,liquidityDelta: 554956482348308200685568,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1680,tickUpper: -1620,liquidityDelta: 613794062772970073358336,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1620,tickUpper: -1560,liquidityDelta: 676430912390927459811328,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1560,tickUpper: -1500,liquidityDelta: 742781738722063525347328,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1500,tickUpper: -1440,liquidityDelta: 812710739024488362409984,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1440,tickUpper: -1380,liquidityDelta: 886028695709823145082880,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1380,tickUpper: -1320,liquidityDelta: 962490796303183152939008,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1320,tickUpper: -1260,liquidityDelta: 1041795295093720935825408,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1260,tickUpper: -1200,liquidityDelta: 1123583122329940944486400,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1200,tickUpper: -1140,liquidityDelta: 1207438531341229494370304,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1140,tickUpper: -1080,liquidityDelta: 1292890854460691893452800,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1080,tickUpper: -1020,liquidityDelta: 1379417415405467468824576,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -1020,tickUpper: -960,liquidityDelta: 1466447619312383376228352,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -960,tickUpper: -900,liquidityDelta: 1553368212572143385313280,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -900,tickUpper: -840,liquidityDelta: 1639529673730123135713280,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -840,tickUpper: -780,liquidityDelta: 1724253664932542925504512,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -780,tickUpper: -720,liquidityDelta: 1806841441690329586597888,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -720,tickUpper: -660,liquidityDelta: 1886583088164554294689792,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -660,tickUpper: -600,liquidityDelta: 1962767416827212355076096,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -600,tickUpper: -540,liquidityDelta: 2034692346272347066466304,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -540,tickUpper: -480,liquidityDelta: 2101675550137646080589824,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -480,tickUpper: -420,liquidityDelta: 2163065154424199664631808,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -420,tickUpper: -360,liquidityDelta: 2218250250707337497018368,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -360,tickUpper: -300,liquidityDelta: 2266670989358179354148864,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -300,tickUpper: -240,liquidityDelta: 2307828020279722045865984,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -240,tickUpper: -180,liquidityDelta: 2341291058900385522515968,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -180,tickUpper: -120,liquidityDelta: 2366706372114275708698624,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -120,tickUpper: -60,liquidityDelta: 2383803002118657672216576,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: -60,tickUpper: 0,liquidityDelta: 2392397575042849161871360,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 0,tickUpper: 60,liquidityDelta: 2392397575042849161871360,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 60,tickUpper: 120,liquidityDelta: 2383803002118663309361152,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 120,tickUpper: 180,liquidityDelta: 2366706372114264434409472,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 180,tickUpper: 240,liquidityDelta: 2341291058900385522515968,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 240,tickUpper: 300,liquidityDelta: 2307828020279722045865984,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 300,tickUpper: 360,liquidityDelta: 2266670989358190360002560,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 360,tickUpper: 420,liquidityDelta: 2218250250707331859873792,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 420,tickUpper: 480,liquidityDelta: 2163065154424194027487232,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 480,tickUpper: 540,liquidityDelta: 2101675550137651449298944,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 540,tickUpper: 600,liquidityDelta: 2034692346272352703610880,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 600,tickUpper: 660,liquidityDelta: 1962767416827206986366976,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 660,tickUpper: 720,liquidityDelta: 1886583088164554294689792,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 720,tickUpper: 780,liquidityDelta: 1806841441690323949453312,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 780,tickUpper: 840,liquidityDelta: 1724253664932548562649088,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 840,tickUpper: 900,liquidityDelta: 1639529673730117498568704,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 900,tickUpper: 960,liquidityDelta: 1553368212572149022457856,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 960,tickUpper: 1020,liquidityDelta: 1466447619312383376228352,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1020,tickUpper: 1080,liquidityDelta: 1379417415405473105969152,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1080,tickUpper: 1140,liquidityDelta: 1292890854460691893452800,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1140,tickUpper: 1200,liquidityDelta: 1207438531341223991443456,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1200,tickUpper: 1260,liquidityDelta: 1123583122329935307341824,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1260,tickUpper: 1320,liquidityDelta: 1041795295093726438752256,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1320,tickUpper: 1380,liquidityDelta: 962490796303183152939008,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1380,tickUpper: 1440,liquidityDelta: 886028695709824487260160,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1440,tickUpper: 1500,liquidityDelta: 812710739024484201660416,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1500,tickUpper: 1560,liquidityDelta: 742781738722069028274176,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1560,tickUpper: 1620,liquidityDelta: 676430912390923299061760,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1620,tickUpper: 1680,liquidityDelta: 613794062772968731181056,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1680,tickUpper: 1740,liquidityDelta: 554956482348315180007424,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1740,tickUpper: 1800,liquidityDelta: 499956458206398706089984,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1800,tickUpper: 1860,liquidityDelta: 448789249865396781056000,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1860,tickUpper: 1920,liquidityDelta: 401411413382037501902848,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1920,tickUpper: 1980,liquidityDelta: 357745349162102438232064,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 1980,tickUpper: 2040,liquidityDelta: 317683957881314706718720,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2040,tickUpper: 2100,liquidityDelta: 281095298351450315292672,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2100,tickUpper: 2160,liquidityDelta: 247827152475545854279680,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2160,tickUpper: 2220,liquidityDelta: 217711415085971921698816,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2220,tickUpper: 2280,liquidityDelta: 190568239914832699064320,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2280,tickUpper: 2340,liquidityDelta: 166209886711128684232704,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2340,tickUpper: 2400,liquidityDelta: 144444228136936908259328,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2400,tickUpper: 2460,liquidityDelta: 125077888155303437926400,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2460,tickUpper: 2520,liquidityDelta: 107918995832380483174400,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2520,tickUpper: 2580,liquidityDelta: 92779549561482794500096,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2580,tickUpper: 2640,liquidityDelta: 79477396485511646806016,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2640,tickUpper: 2700,liquidityDelta: 67837840229619736772608,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2700,tickUpper: 2760,liquidityDelta: 57694896900316875194368,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2760,tickUpper: 2820,liquidityDelta: 48892224664355739795456,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2820,tickUpper: 2880,liquidityDelta: 41283756137253206753280,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2880,tickUpper: 2940,liquidityDelta: 34734065383715593256960,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 2940,tickUpper: 3000,liquidityDelta: 29118502677572455759872,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3000,tickUpper: 3060,liquidityDelta: 24323130434952420655104,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3060,tickUpper: 3120,liquidityDelta: 20244493078665747234816,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3120,tickUpper: 3180,liquidityDelta: 16789252177316984913920,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3180,tickUpper: 3240,liquidityDelta: 13873716193693836247040,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3240,tickUpper: 3300,liquidityDelta: 11423291728076122095616,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3300,tickUpper: 3360,liquidityDelta: 9371880400395958222848,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3360,tickUpper: 3420,liquidityDelta: 7661242608398665515008,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3420,tickUpper: 3480,liquidityDelta: 6240346442563658448896,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3480,tickUpper: 3540,liquidityDelta: 5064717126666516692992,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3540,tickUpper: 3600,liquidityDelta: 4095799564184963776512,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3600,tickUpper: 3660,liquidityDelta: 3300343961909354037248,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3660,tickUpper: 3720,liquidityDelta: 2649822119789638713344,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3720,tickUpper: 3780,liquidityDelta: 2119879843729867276288,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3780,tickUpper: 3840,liquidityDelta: 1689829072327091159040,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3840,tickUpper: 3900,liquidityDelta: 1342181712763875753984,salt: 0}),
            IPoolManager.ModifyLiquidityParams({tickLower: 3900,tickUpper: 3960,liquidityDelta: 1062225846231269900288,salt: 0})
        ];
    }
}
